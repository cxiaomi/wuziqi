<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>双人对战五子棋 - temptation</title>
    <style type="text/css">
        #center{
            text-align:center;
        }
        table {
            border: 1px solid black;
            border-collapse: collapse;
            background-color: burlywood;
            margin:0 auto
        }
        
        td {
            border: 1px solid black;
            width: 40px;
            height: 40px;
        }
    </style>
    <script type="text/javascript">
        var currentColor = 'black';
        var chessHistory = []; // 存储棋盘状态

        window.onload = function () {
            document.getElementById('spanColor').innerText = currentColor;
            var chessboard = document.getElementById('chessboard');
            chessboard.onclick = function (event) {
                var obj = event.target;
                if (obj.style.backgroundColor) {
                    alert('该位置已经有棋子，不能再落子！');
                } else {
                    obj.style.backgroundColor = currentColor;
                    obj.style.borderRadius = '50%';
                    var currentChess = {
                        x: obj.cellIndex,
                        y: obj.parentNode.rowIndex,
                        color: currentColor
                    };
                    chessHistory.push(currentChess); // 记录棋盘状态
                    togglePlayer();
                    checkWin(obj, currentChess);
                }
            };
            document.getElementById('btnRegret').onclick = function () {
                regret();
            };
        };

        function togglePlayer() {
            currentColor = (currentColor == 'black') ? 'white' : 'black';
            document.getElementById('spanColor').innerText = currentColor;
        }

        function checkWin(obj, currentChess) {
            var flag = (currentColor == 'black' ? 'bbbbb' : 'wwww');
            var tdArr = document.getElementById('chessboard').getElementsByTagName('td');
            var result = ['', '', '', ''];
            for (var i = 0; i < tdArr.length; i++) {
                var tempChess = {
                    x: tdArr[i].cellIndex,
                    y: tdArr[i].parentNode.rowIndex,
                    color: '0' // 位置上无棋子
                };
                if (tdArr[i].style.backgroundColor == 'black') {
                    tempChess.color = 'b';
                } else if (tdArr[i].style.backgroundColor == 'white') {
                    tempChess.color = 'w';
                }
                if (currentChess.y == tempChess.y) {
                    result[0] += tempChess.color;
                }
                if (currentChess.x == tempChess.x) {
                    result[1] += tempChess.color;
                }
                if ((currentChess.x - tempChess.x) == (currentChess.y - tempChess.y)) {
                    result[2] += tempChess.color;
                }
                if ((currentChess.x + currentChess.y) == (tempChess.x + tempChess.y)) {
                    result[3] += tempChess.color;
                }
            }
            for (var i = 0; i < result.length; i++) {
                if(result[i].indexOf(flag) >= 0) {
                    alert((currentColor == 'black' ? '黑棋' : '白棋') + '获胜！');
                    chessHistory = []; // 清空棋盘状态
                    break;
                }
            }
        }

        function regret() {
            if (chessHistory.length === 0) {
                alert('没有可以悔的棋！');
                return;
            }
            var lastMove = chessHistory.pop(); // 撤销最后一步棋
            var obj = document.getElementById('chessboard').rows[lastMove.y].cells[lastMove.x];
            obj.style.backgroundColor = '';
            togglePlayer(); // 切换玩家
        }
    </script>
</head>
<body>
    <div id="center">
        <h3>双人对战五子棋</h3>
        <div id="divMsg">
            落子者为：<span id="spanColor"></span>
            <button id="btnRegret">悔棋</button>
        </div>
        <table id="chessboard">
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
			</table>
		</div>
	<!-- </center> -->
	</body>
</html>

